<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8"/>
  <meta name="viewport" content="width=device-width, initial-scale=1"/>
  <meta name="theme-color" content="#0b1020"/>
  <title>SkySoft Crash HackBot</title>
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;600;700&display=swap" rel="stylesheet">
  <style>
    :root{
      --bg:#0b1020; --panel:#121936; --muted:#7f8db3; --text:#e8eeff;
      --accent:#ffa86b; --accent2:#ffd36b; --good:#66e6a3; --warn:#ffcc66; --bad:#ff6b6b
    }
    *{box-sizing:border-box}
    html,body{height:100%}
    body{
      margin:0;font-family:Inter,system-ui,Segoe UI,Roboto,Arial,sans-serif;color:var(--text);
      background:
        radial-gradient(1200px 800px at 15% -10%,rgba(255,168,107,.15),transparent),
        radial-gradient(1100px 700px at 85% 110%,rgba(255,211,107,.10),transparent),
        #0b1020;
    }
    .wrap{max-width:980px;margin:32px auto;padding:0 16px}
    .card{background:linear-gradient(180deg,#121936,#0d1330);border:1px solid rgba(255,255,255,.06);
      border-radius:20px;box-shadow:0 8px 40px rgba(0,0,0,.4);overflow:hidden}

    header{padding:18px 16px;border-bottom:1px solid rgba(255,255,255,.06);display:flex;gap:12px;align-items:center}
    .logo{width:40px;height:40px;border-radius:12px;display:grid;place-items:center;
      background:linear-gradient(135deg,var(--accent),var(--accent2));color:#0b1020;font-weight:800}
    header h1{margin:0;font-size:19px}
    header p{margin:0;color:var(--muted);font-size:13px}
    .back-btn{background:transparent;border:1px solid rgba(255,255,255,.2);color:var(--text);
      font-size:13px;padding:6px 10px;border-radius:8px;cursor:pointer;margin-right:8px}
    .back-btn:hover{background:rgba(255,255,255,.08)}

    .grid{display:grid;grid-template-columns:1.15fr .85fr;gap:20px;padding:16px}
    @media (max-width:860px){.grid{grid-template-columns:1fr;gap:14px;padding:12px}}

    .panel{background:rgba(255,255,255,.03);border:1px solid rgba(255,255,255,.06);border-radius:16px;padding:14px}
    .panel h2{margin:0 0 10px;font-size:15px}

    label{display:block;font-size:13px;color:var(--muted);margin:10px 0 6px}
    input[type="time"],input[type="number"],input[type="text"],textarea,select{
      width:100%;background:#0b1024;border:1px solid rgba(255,255,255,.08);color:var(--text);
      padding:12px;border-radius:12px;font-size:16px;outline:none}
    textarea{min-height:82px;resize:vertical}
    input:focus,select:focus,textarea:focus{border-color:var(--accent)}
    .row{display:grid;grid-template-columns:1fr 1fr;gap:12px}
    @media (max-width:560px){.row{grid-template-columns:1fr}}

    button{appearance:none;border:0;background:linear-gradient(135deg,var(--accent),#ff8d4d);color:#101018;
      padding:12px 16px;border-radius:12px;font-weight:800;letter-spacing:.2px;cursor:pointer;
      box-shadow:0 6px 20px rgba(255,168,107,.35)}
    button.secondary{background:transparent;color:var(--text);border:1px dashed rgba(255,255,255,.2);box-shadow:none}
    .actions{display:flex;gap:12px;margin-top:14px}
    @media (max-width:560px){.actions{flex-direction:column} .actions button{width:100%}}

    .sys{font-family:ui-monospace,SFMono-Regular,Menlo,monospace;background:#0a0f22;border:1px solid rgba(255,255,255,.06);
      border-radius:12px;padding:12px;min-height:110px;max-height:230px;overflow:auto;color:#cfe3ff;font-size:13px;line-height:1.5}
    .progress{height:10px;border-radius:999px;background:#0c1230;border:1px solid rgba(255,255,255,.06);overflow:hidden}
    .bar{height:100%;width:0;background:linear-gradient(90deg,var(--accent),var(--accent2));transition:width .25s ease}

    .signals{display:grid;gap:12px}
    .sig{border:1px solid rgba(255,255,255,.06);border-radius:14px;padding:12px;background:rgba(255,255,255,.03)}
    .sig h3{margin:0 0 6px;font-size:15px}
    .sig p{margin:4px 0;color:var(--muted)}
    .badge{display:inline-block;padding:4px 8px;border-radius:999px;font-size:12px;font-weight:700}
    .safe{background:rgba(102,230,163,.15);color:#8bffca;border:1px solid rgba(102,230,163,.5)}
    .risk{background:rgba(255,204,102,.15);color:#ffdf9a;border:1px solid rgba(255,204,102,.5)}
    .coach{background:rgba(255,168,107,.18);color:#ffe5c9;border:1px solid rgba(255,168,107,.5)}
    .copy{background:#121b3e;color:#dfe8ff;border:1px solid rgba(255,255,255,.12)}

    .heat{
      height:14px;border-radius:999px;background:#141a38;border:1px solid rgba(255,255,255,.06);overflow:hidden;position:relative
    }
    .heat .fill{
      height:100%;width:18%;background:linear-gradient(90deg,#2ee6a6,#ffe36b,#ff6b6b);
      transition:width .6s ease
    }
    .heat .tick{position:absolute;inset:0;opacity:.18;background:
      repeating-linear-gradient(90deg,transparent 0 12px,rgba(255,255,255,.4) 12px 13px)}

    .hint{color:#9fb6ff}
    .small{font-size:12px;color:var(--muted)}
  </style>
</head>
<body>
  <div class="wrap">
    <div class="card">
      <header>
        <button onclick="location.href='../../index.html'" class="back-btn">← Back</button>
        <div class="logo">⚡</div>
        <div>
          <h1>SkySoft Crash HackBot</h1>
          <p>Risk profile • Heat meter • Streak analyzer • Stake split</p>
        </div>
      </header>

      <div class="grid">
        <!-- LEFT -->
        <section class="panel">
          <h2>1) Session setup</h2>
          <div class="row">
            <div>
              <label for="time">Planned round time (HH:MM)</label>
              <input id="time" type="time" required>
            </div>
            <div>
              <label for="stake">Stake (LKR)</label>
              <input id="stake" type="number" min="50" step="10" placeholder="e.g. 2400">
            </div>
          </div>

          <div class="row">
            <div>
              <label for="risk">Risk profile</label>
              <select id="risk">
                <option value="conservative">Conservative</option>
                <option value="standard" selected>Standard</option>
                <option value="aggressive">Aggressive</option>
              </select>
            </div>
            <div>
              <label for="split">Stake split (A/B)</label>
              <select id="split">
                <option value="1">100% / 0%</option>
                <option value="0.8" selected>60% / 40%</option>
                <option value="0.67">67% / 33%</option>
                <option value="0.5">50% / 50%</option>
              </select>
            </div>
          </div>

          <label for="history">Recent multipliers (paste 8–12, space‑separated)</label>
          <textarea id="history" placeholder="e.g. 1.42 1.10 2.30 1.06 3.10 1.18 1.25 2.05"></textarea>

          <div class="actions">
            <button id="generate">Generate Plan</button>
            <button id="clear" class="secondary">Clear</button>
          </div>

          <h2 style="margin-top:14px">2) Sync & Heat</h2>
          <div class="progress" aria-hidden="true"><div class="bar" id="bar"></div></div>
          <div class="sys" id="syslog" aria-live="polite"></div>
          <div style="margin-top:10px">
            <div class="small">Heat meter (volatility / spike chance)</div>
            <div class="heat" aria-hidden="true"><div class="fill" id="heatfill"></div><div class="tick"></div></div>
          </div>
        </section>

        <!-- RIGHT -->
        <section class="panel">
          <h2>3) Signal package</h2>
          <div class="signals" id="signals">
            <div class="small">No plan yet. Fill the form and press <span class="hint">Generate Plan</span>.</div>
          </div>
        </section>
      </div>

      <div class="footer" style="padding:12px 16px;border-top:1px solid rgba(255,255,255,.06);display:flex;justify-content:space-between;gap:10px;flex-wrap:wrap;color:var(--muted);font-size:12px">
        <div>Auto‑pause after fail. Never chase more than 2 losses. Respect session cap.</div>
        <div>Crash v0.1 — SkySoft</div>
      </div>
    </div>
  </div>

  <script>
    const $ = s => document.querySelector(s);
    const log = m => { const box = $('#syslog'); box.innerHTML += m + "\\n"; box.scrollTop = box.scrollHeight; };
    const tfmt = t => { if(!t) return ''; const [h,m]=t.split(':'); return `${(''+h).padStart(2,'0')}:${(''+m).padStart(2,'0')}`; };

    function seededRand(seed){
      let x = 1779033703 ^ seed.length;
      for(let i=0;i<seed.length;i++) x = Math.imul(x ^ seed.charCodeAt(i), 3432918353) >>> 0;
      x ^= x >>> 13; x = Math.imul(x, 3266489909) >>> 0; x ^= x >>> 16;
      return ()=> (x = (x + 0x6D2B79F5) >>> 0, (x ^ (x>>>15)) / 2**32);
    }

    function parseHistory(str){
      return (str||"")
        .split(/[\s,;]+/).map(v=>parseFloat(v)).filter(v=>isFinite(v) && v>0.9 && v<100).slice(-14);
    }

    function analyzeStreak(arr){
      if(arr.length<4) return {avg:1.3, lows:0, highs:0, hot:false};
      const lows = arr.filter(x=>x<1.3).length;
      const highs = arr.filter(x=>x>=2.0).length;
      const avg = arr.reduce((a,b)=>a+b,0)/arr.length;
      const hot = highs>=Math.max(2, Math.floor(arr.length/5));
      return {avg,lows,highs,hot};
    }

    function simulateSync(){
      $('#syslog').textContent='';
      const bar = $('#bar'); bar.style.width='0%';
      const t = $('#time').value||'—';
      const st = $('#stake').value||'—';
      const risk = $('#risk').value;
      log('> Connecting to Crash engine…');
      const steps = [
        'Handshake OK',
        'Fetching last rounds…',
        `Risk profile: ${risk} · Stake ${st} · Time ${t}`,
        'Estimating volatility…',
        'Compiling plan…',
        'Signal package: READY'
      ];
      let p=0;
      const timer = setInterval(()=>{
        p += Math.random()*18+6; if(p>=100){p=100; clearInterval(timer);}
        bar.style.width = p+'%';
        if(steps.length) log('> '+steps.shift());
        if(p===100) generatePlan();
      }, 450);
    }

    function generatePlan(){
      const time  = $('#time').value;
      const stake = parseFloat($('#stake').value||'0');
      const risk  = $('#risk').value;
      const splitA = parseFloat($('#split').value); // A part
      const splitB = Math.max(0, 1 - splitA);

      const hist = parseHistory($('#history').value);
      const stat = analyzeStreak(hist);

      const rnd = seededRand(`${time}|${stake}|${risk}|${splitA}|${hist.join(',')}`);
      // Heat (0..1) influenced by streak & randomness
      let heat = 0.25 + (stat.hot? 0.25:0) + Math.min(0.3, Math.max(0, (stat.avg-1.2)*0.5)) + (rnd()*0.25);
      heat = Math.max(0.05, Math.min(0.98, heat));
      $('#heatfill').style.width = Math.round(heat*100)+'%';

      // choose targets by risk & heat
      function pickTargets(){
        const baseSafe = 1.20 + heat*0.30;         // 1.20–1.50
        const baseRisk = 1.8  + heat* (risk==='aggressive'? 2.4 : 1.7); // ~1.8–4.2+
        let safe = +(baseSafe + (rnd()*0.08 - 0.04)).toFixed(2);
        let high = +(baseRisk + (rnd()*0.40 - 0.15)).toFixed(2);

        if(risk==='conservative'){ high = Math.max(1.90, Math.min(2.6, high)); }
        if(risk==='aggressive'){   high = Math.max(2.4, high*1.05); }
        return {safe, high};
      }

      const {safe, high} = pickTargets();

      // entry window & pauses
      const skipRounds = stat.lows>=Math.ceil((hist.length||6)/2) ? 1 : 0; // too many lows -> skip 1
      const windowSec  = 10 + Math.round(heat*25); // 10–35s

      const aStake = Math.round(stake*splitA);
      const bStake = Math.round(stake*splitB);

      // EV-ish readout (toy)
      const pSafe = 0.70 + heat*0.12 - (risk==='aggressive'?0.05:0); // 0.7..0.87
      const pHigh = 0.35 + heat*0.18 + (risk==='aggressive'?0.08:0) - (risk==='conservative'?0.05:0); // 0.35..0.61
      const evA = aStake * pSafe * safe;
      const evB = bStake * pHigh * high;

      const tips = [
        'If first loss — pause one round and cut stake by 30%.',
        'Don’t chase deep spikes twice in a row.',
        'Respect two‑loss stop and reset the session.',
        'If heat > 70%, widen entry window by +5s.'
      ];
      const tip = tips[Math.floor(rnd()*tips.length)];

      const fmt = n => n.toLocaleString(undefined,{maximumFractionDigits:0});

      $('#signals').innerHTML = `
        <div class="sig">
          <h3>Auto Cash‑Out <span class="badge safe">SAFE</span></h3>
          <p><b>Target:</b> ${safe.toFixed(2)}x · <b>Window:</b> next ${windowSec}s</p>
          <p><b>Stake A:</b> LKR ${fmt(aStake)} (${Math.round(splitA*100)}%) · <b>Prob:</b> ${(pSafe*100|0)}%</p>
          <p class="small">Entry discipline > accuracy. Use auto after skip ${skipRounds} round(s).</p>
          <div style="display:flex;gap:8px;margin-top:8px">
            <button class="copy" data-copy="CRASH SAFE — auto ${safe.toFixed(2)}x, stake LKR ${aStake}, window ${windowSec}s">Copy</button>
          </div>
        </div>

        <div class="sig">
          <h3>Manual Spike <span class="badge risk">AGGRESSIVE</span></h3>
          <p><b>Target:</b> ${high.toFixed(2)}x · <b>Window:</b> next ${Math.max(12,windowSec-2)}s</p>
          <p><b>Stake B:</b> LKR ${fmt(bStake)} (${Math.round(splitB*100)}%) · <b>Prob:</b> ${(pHigh*100|0)}%</p>
          <p class="small">Tip: ${tip}</p>
          <div style="display:flex;gap:8px;margin-top:8px">
            <button class="copy" data-copy="CRASH HIGH — manual ${high.toFixed(2)}x, stake LKR ${bStake}, window ${Math.max(12,windowSec-2)}s">Copy</button>
          </div>
        </div>

        <div class="sig">
          <h3>Coach Note <span class="badge coach">ADAPTIVE</span></h3>
          <p><b>Heat:</b> ${(heat*100|0)}% · <b>Streak:</b> avg ${stat.avg.toFixed(2)}x · lows ${stat.lows} · highs ${stat.highs}</p>
          <p>Auto‑pause after any fail. Resume only if next round opens under 1.30×.</p>
          <div style="display:flex;gap:8px;margin-top:8px">
            <button class="copy" data-copy="COACH — heat ${(heat*100|0)}%, skip ${skipRounds}, safe ${safe.toFixed(2)}x, high ${high.toFixed(2)}x">Copy</button>
          </div>
        </div>
      `;
    }

    // EVENTS
    $('#generate').addEventListener('click', ()=>{
      if(!$('#time').value){ alert('Please set your planned round time.'); return; }
      simulateSync();
    });
    $('#clear').addEventListener('click', ()=>{
      $('#time').value=''; $('#stake').value=''; $('#risk').value='standard'; $('#split').value='0.8'; $('#history').value='';
      $('#syslog').textContent=''; $('#bar').style.width='0%'; $('#heatfill').style.width='18%';
      $('#signals').innerHTML = '<div class="small">No plan yet. Fill the form and press <span class="hint">Generate Plan</span>.</div>';
    });
    document.addEventListener('click', (e)=>{
      const btn = e.target.closest('.copy'); if(!btn) return;
      const t = btn.getAttribute('data-copy');
      navigator.clipboard.writeText(t).then(()=>{ btn.textContent='Copied!'; setTimeout(()=>btn.textContent='Copy',1200); });
    });
  </script>
</body>
</html>
